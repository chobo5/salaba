<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset="UTF-8">
  <title>chat</title>
</head>
<body>
  <div id="messageContainer"></div>
  <input type="text" id="messageInput" placeholder="메시지 입력">
  <button onclick="sendMessage()">Send</button>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    const ws = new WebSocket('ws://localhost:8889');
    const requestData = {
      message:'getChat',
      reservationNo : 1,
      chatName: 'chat.json'
    }
    ws.onopen = function(event){
      ws.send(JSON.stringify(requestData));
    }

    ws.onmessage = function(event){
      console.log(event.data);
      const message = JSON.parse(event.data);
      console.log(message);
      const messageContainer = document.getElementById('messageContainer');
      message.forEach((element) => {
        let messageElement = document.createElement('div');
        let messageContent = document.createElement('span');
        messageContent.textContent = element.content;
        messageElement.appendChild(messageContent);
        messageContainer.appendChild(messageElement);
      });
    };

    function sendMessage(){
      const messageInput = document.getElementById('messageInput');
      const message = {
        name: '11',
        sender: 'guest',
        timestamp: new Date().toISOString(),
        content: messageInput.value
      };

      ws.send(JSON.stringify(message));
      messageInput.value = '';
    }

  </script>
</body>